{% extends "base.html" %}

{% block title %}Dashboard - Ayurvedic Clinic{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="text-center" style="color: #2E8B57;">
                <i class="fas fa-leaf"></i> Ayurvedic Clinic Management System
            </h1>
            <div>
                <button type="button" class="btn btn-outline-info btn-sm me-2" data-bs-toggle="modal" data-bs-target="#helpModal">
                    <i class="fas fa-question-circle"></i> Help
                </button>
                <a href="{{ url_for('logout') }}" class="btn btn-outline-danger btn-sm">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-users fa-2x mb-2"></i>
                <h3>{{ stats.total_patients }}</h3>
                <p>Total Patients</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-clipboard-list fa-2x mb-2"></i>
                <h3>{{ stats.total_visits }}</h3>
                <p>Total Visits</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-user-plus fa-2x mb-2"></i>
                <h3>{{ stats.recent_patients }}</h3>
                <p>New (7 days)</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stats-card">
            <div class="card-body text-center">
                <i class="fas fa-calendar-check fa-2x mb-2"></i>
                <h3>{{ stats.recent_visits }}</h3>
                <p>Recent Visits</p>
            </div>
        </div>
    </div>
</div>

<!-- Daily Health Tip -->
{% if health_tip %}
<div class="row mb-4">
    <div class="col-12">
        <div class="card" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white;">
            <div class="card-header" style="background: transparent; border-bottom: 1px solid rgba(255,255,255,0.2);">
                <h5 class="mb-0">
                    <i class="fas fa-lightbulb"></i> Daily Health Tip - {{ health_tip.category }}
                </h5>
            </div>
            <div class="card-body">
                <p class="lead mb-2">{{ health_tip.content }}</p>
                {% if health_tip.benefit %}
                <p class="mb-0"><strong>Benefit:</strong> {{ health_tip.benefit }}</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Quick Actions -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-bolt"></i> Quick Actions
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <a href="{{ url_for('add_patient_route') }}" class="btn btn-primary btn-lg w-100 mb-2">
                            <i class="fas fa-user-plus"></i> Add New Patient
                        </a>
                    </div>
                    <div class="col-md-4">
                        <a href="{{ url_for('search') }}" class="btn btn-outline-primary btn-lg w-100 mb-2">
                            <i class="fas fa-search"></i> Search Patients
                        </a>
                    </div>
                    <div class="col-md-4">
                        <a href="{{ url_for('all_patients') }}" class="btn btn-outline-primary btn-lg w-100 mb-2">
                            <i class="fas fa-users"></i> View All Patients
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Admin Panel Section -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card border-warning">
            <div class="card-header bg-warning text-dark">
                <i class="bi bi-shield-lock"></i> Admin Panel - Enterprise Management
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <a href="{{ url_for('admin_deleted_records') }}" class="btn btn-outline-danger btn-lg w-100 mb-2">
                            <i class="bi bi-trash"></i> Manage Deleted Records
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('admin_audit_log') }}" class="btn btn-outline-info btn-lg w-100 mb-2">
                            <i class="bi bi-journal-text"></i> System Audit Log
                        </a>
                    </div>
                </div>
                <div class="alert alert-warning mt-3 mb-0">
                    <small><i class="bi bi-info-circle"></i> Enterprise features: Comprehensive audit trails, data recovery, and compliance monitoring</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Patients -->
{% if recent_patients %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-history"></i> Recently Added Patients
            </div>
            <div class="card-body">
                {% for patient in recent_patients %}
                <div class="patient-card card">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="card-title mb-1">
                                    <i class="fas fa-user"></i> {{ patient.name }}
                                </h5>
                                <p class="card-text mb-1">
                                    <strong>Age:</strong> {{ patient.age }} years | 
                                    <strong>Gender:</strong> {{ patient.gender }}
                                </p>
                                <p class="card-text mb-1">
                                    <i class="fas fa-phone"></i> {{ patient.phone }}
                                </p>
                                <p class="card-text mb-1">
                                    <strong>Conditions:</strong> {{ patient.conditions or 'None recorded' }}
                                </p>
                                <span class="date-badge">
                                    <i class="fas fa-calendar"></i> Registered: {{ patient.created_date_formatted }}
                                </span>
                            </div>
                            <div class="col-md-4 text-end">
                                <a href="{{ url_for('patient_details', patient_id=patient.patient_id) }}" 
                                   class="btn btn-primary">
                                    <i class="fas fa-eye"></i> View Details
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body text-center">
                <i class="fas fa-user-plus fa-3x text-muted mb-3"></i>
                <h4>No Patients Yet</h4>
                <p class="text-muted">Start by adding your first patient to the clinic.</p>
                <a href="{{ url_for('add_patient_route') }}" class="btn btn-primary btn-lg">
                    <i class="fas fa-user-plus"></i> Add First Patient
                </a>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Help Modal -->
<div class="modal fade" id="helpModal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="helpModalLabel">
                    <i class="fas fa-question-circle me-2"></i>Help & Support
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6 class="text-primary"><i class="fas fa-user-md me-2"></i>Clinic Operations</h6>
                        <ul class="list-unstyled">
                            <li class="mb-2"><strong>Add Patients:</strong> Use the "Add New Patient" button</li>
                            <li class="mb-2"><strong>Search:</strong> Find patients by name or phone number</li>
                            <li class="mb-2"><strong>Record Visits:</strong> Click on any patient to add visit details</li>
                            <li class="mb-2"><strong>View History:</strong> Access complete patient visit history</li>
                        </ul>
                        
                        <h6 class="text-primary mt-4"><i class="fas fa-keyboard me-2"></i>Quick Tips</h6>
                        <ul class="list-unstyled">
                            <li class="mb-2">• Use search to quickly find existing patients</li>
                            <li class="mb-2">• Double-check patient details before saving</li>
                            <li class="mb-2">• Record weight and vital signs for better tracking</li>
                            <li class="mb-2">• Add detailed notes for each visit</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6 class="text-primary"><i class="fas fa-headset me-2"></i>Technical Support</h6>
                        <div class="bg-light p-3 rounded">
                            <h6 class="text-dark mb-3">Contact for help with:</h6>
                            <ul class="list-unstyled text-dark">
                                <li>• Login issues</li>
                                <li>• App not working properly</li>
                                <li>• Questions about features</li>
                                <li>• Any technical problems</li>
                            </ul>
                            
                            <hr>
                            
                            <div class="text-center">
                                <h6 class="text-primary mb-2">Harshad Agrawal</h6>
                                <p class="mb-1"><strong>App Developer & Support</strong></p>
                                <p class="mb-1">
                                    <i class="fas fa-phone me-2"></i>
                                    <a href="tel:7622871384" class="text-decoration-none">7622871384</a>
                                </p>
                                <p class="mb-0">
                                    <i class="fas fa-envelope me-2"></i>
                                    <a href="mailto:harshadd.agrawal2005@gmail.com" class="text-decoration-none">
                                        harshadd.agrawal2005@gmail.com
                                    </a>
                                </p>
                            </div>
                        </div>
                        
                        <div class="mt-3 p-2 bg-success text-white rounded text-center">
                            <small><i class="fas fa-clock me-1"></i>Usually responds within a few hours</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <a href="/clinic-info" class="btn btn-primary">View Clinic Info</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}